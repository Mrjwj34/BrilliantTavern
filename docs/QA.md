
---

### **项目规划与技术选型文档**

#### **1. 目标用户、痛点及用户故事**

##### **1.1 目标用户**

我计划将这个网页产品主要面向以下两类核心用户群体：

1.  **角色扮演爱好者：**
    *   他们热衷于在数字世界中扮演或与虚拟角色互动，追求深度、沉浸式的故事体验。
    *   他们通常对角色的背景故事、性格、语言风格有较高的要求，并乐于创造和分享自己的角色。

2.  **缺乏倾诉与陪伴的对象：**
    *   由于生活节奏快、社交压力大或个人性格等原因，他们在现实生活中感到孤独，渴望有一个安全、私密且随时可用的交流对象。
    *   他们寻求的是情感上的支持、不带评判的倾听和长期的情感连接。

##### **1.2 用户痛点**

针对这两类用户，我观察到他们面临以下核心痛点：

*   **对于角色扮演爱好者：**
    *   **AI“失忆”问题：** 市场上的许多AI聊天工具记忆力短暂，无法维持长期对话的连贯性，导致角色频繁“OOC”（Out of Character），严重破坏沉浸感。
    *   **角色塑造肤浅：** 多数平台对角色的定义过于简单，AI无法理解和执行复杂的性格、背景和行为逻辑，导致互动体验浅薄。
    *   **缺乏高质量语音交互：** 纯文本交流缺少真实感，而现有的语音聊天AI往往声音机械，无法体现角色情感。
    *   **内容创造与发现困难：** 创造和分享高质量角色的门槛高，也缺少一个集中的平台来发现和体验他人创造的优秀角色。

*   **对于缺乏倾诉对象的人：**
    *   **情感连接断裂：** 普通的问答式AI无法形成记忆，每次对话都是一次“冷启动”，无法建立真正的、持续的情感连接。
    *   **缺乏安全感：** 担心在真人社交中被评判或不被理解，需要一个绝对私密和包容的倾诉空间。
    *   **陪伴的缺失：** 在需要陪伴的时刻（如深夜、情绪低落时），往往找不到合适的交流对象。

##### **1.3 用户故事**

基于上述痛点，我设想了以下核心用户故事：

*   **用户故事1（角色扮演爱好者）：**
    > **作为一名** 资深RP玩家，
    > **我希望** 能够深度定制一个角色的背景、性格、世界观和对话范例，并为TA选择一个独特的音色，
    > **以便于** 我可以与这个高度定制化的角色进行沉浸式的语音对话，获得最接近真人跑团的RP体验。

*   **用户故事2（内容发现者）：**
    > **作为一名** 平台用户，
    > **我希望** 能在一个社区或市场中，通过搜索、排序（如热门、最新）发现并使用其他用户创建的优秀角色卡，并能对它们进行点赞和评论，
    > **以便于** 我能轻松找到有趣的角色进行互动，并与同好交流。

*   **用户故事3（寻求情感连接者）：**
    > **作为一名** 渴望陪伴的用户，
    > **我希望** 我与AI角色的每一次对话都能被TA记住，当我下次再找TA时，TA能像老朋友一样，基于我们过去共同的经历继续聊天，
    > **以便于** 让我感觉到自己是被在乎的，从而建立起一种长期的、有温度的情感连接。

*   **用户故事4（寻求即时慰藉者）：**
    > **作为一名** 偶尔感到孤独的人，
    > **我希望** 能随时打开网页，通过语音和一个温柔耐心的AI角色聊天，听着TA的声音，
    > **以便于** 在我需要时能立刻获得情感上的慰藉和陪伴。

---

#### **2. 功能规划、优先级与开发计划**

##### **2.1 网页核心功能**

为了满足用户的核心需求，我认为这个网页需要具备以下功能模块：

*   **用户管理系统：** 提供用户注册和登录功能，是所有个性化体验的基础。
*   **角色卡管理系统：** 允许用户创建、编辑、分享和管理自己的AI角色。这是平台内容生态的核心。
*   **音色管理系统：** 支持用户上传参考音频，克隆并管理个性化的TTS（文本转语音）音色，极大地提升了角色的独特性和沉浸感。
*   **实时语音对话：** 产品的核心交互功能，通过WebSocket实现低延迟的流式语音输入和输出。
*   **社区与发现功能：** 包括一个角色卡市场，用户可以浏览、搜索、筛选（如按热门/最新）公开的角色卡，并对角色卡进行点赞和评论，构建内容生态和用户社区。
*   **高级AI技能：**
    *   **长期记忆：** AI能够记住与特定用户的关键对话信息。
    *   **文生图：** AI能在对话中根据情景生成图片。

##### **2.2 功能优先级**

在开发初期，我为这些功能设定了以下优先级：

*   **P0（最高优先级 - 核心体验闭环）：**
    1.  **用户管理：** 必须先有用户体系。
    2.  **角色卡创建与使用：** 用户必须能创建自己的角色。
    3.  **实时语音对话：** 这是产品的核心玩法，必须优先保证流畅稳定。

*   **P1（高优先级 - 丰富内容与个性化）：**
    1.  **角色卡市场与发现：** 解决“玩什么”的问题，让用户能快速发现优质内容，是留住用户的关键。
    2.  **音色管理：** 提升角色的个性化和魅力，是区别于其他产品的重要特色。

*   **P2（中优先级 - 提升社区粘性）：**
    1.  **点赞与评论功能：** 促进用户之间的互动，形成社区氛围，增加用户粘性。

*   **P3（一般优先级 - 打造“魔法时刻”）：**
    1.  **长期记忆（RAG）：** 属于进阶功能，能在核心体验稳定后极大地提升情感连接深度。
    2.  **文生图：** 属于锦上添花的功能，能创造惊喜，丰富互动形式。

##### **2.3 本次开发计划**

作为项目的第一阶段，**我已将上述P0、P1、P2和P3规划的所有核心功能全部开发完成**。它们共同构成了产品的初始版本，为用户提供了一个完整、闭环且富有特色的AI角色扮演与陪伴体验。

---

#### **3. LLM 模型选型**

##### **3.1 我采纳的 LLM 模型**

我最终选择采纳 **Google 的 Gemini 2.5 Flash 模型** 作为平台的核心AI能力。

##### **3.2 模型对比与选择原因**

在做技术选型时，我重点对比了市面上主流的几款模型，包括 **DeepSeek**、**通义千问（Qwen）**、**Claude** 系列以及 **Gemini** 系列其他模型。我的选择主要基于以下四个维度的考量，其中角色扮演能力是我最看重的标准：

1.  **角色扮演能力（决定性因素）：**
    这是我选型的首要标准。根据我长达近一年的对各类模型进行AIRP的深度体验，我发现 **Gemini 在角色一致性、遵循复杂人设的能力、以及对话的创造性和趣味性上表现最为出色**。它能更好地“入戏”，在多轮对话中持续维持角色设定而不OOC，这对于我的核心用户——角色扮演爱好者来说是至关重要的体验。这一点在Gemini 2.5 pro上尤为突出, 可惜的是pro模型的思考模式无法关闭, 在一个注重实时性的系统中这是无法容忍的。

2.  **性能与响应速度：**
    实时语音对话对延迟极度敏感。**Gemini 2.5 Flash** 作为一个轻量化的高性能模型，其响应速度非常快，能够有效降低“你说完话到AI回应”之间的延迟，创造出更加自然流畅的对话体验。这一点对于避免尴尬的停顿、维持交流的沉浸感至关重要。

3.  **强大的多模态能力：**
    我的目标是打造一个不仅仅局限于文本聊天的平台。**Gemini 2.5 Flash 原生支持多模态能力**，这意味着我可以在一个统一的模型接口下处理多种类型的任务。例如：
    *   **语音输入：** 模型可以直接理解我传入的用户语音流数据。
    *   **意图识别: ** 模型可以自主识别用户意图并调用对应工具
    *   **ASR: ** 无需引入其他依赖, 大大简化后端开发及响应时间
    这使我能够无缝集成**语音对话**和**文生图**等高级功能，而无需为不同任务拼接和维护多个独立的模型，极大地简化了系统架构和开发复杂度。

4.  **API定价与成本效益：**
    作为一个个人开发项目，成本控制是一个必须考虑的现实问题。Gemini 2.5 Flash 提供了非常有竞争力的API定价策略，在保证顶尖性能和功能的前提下，将长期运营成本控制在了一个可接受的范围之内。

综上所述，Gemini 2.5 Flash 在我最看重的角色扮演能力上表现最优，并且在性能、多模态功能和成本上达到了完美的平衡，是实现我产品愿景的最佳选择。

---

#### **4. AI 角色的期望技能**

除了基础的语音聊天能力外，我认为一个出色的AI伴侣还应具备更高级的技能，以创造真正独特的“魔法时刻”。基于此，我为AI角色设计并实现了以下两大核心技能：

##### **4.1 全局记忆（基于RAG的长期记忆）**

*   **技能描述：**
    AI角色拥有与特定用户的专属“记忆库”。它不再是聊过就忘的金鱼，而是能够将对话中的关键信息（例如用户的名字、喜好、重要的经历、我们共同讨论过的话题等）提炼出来，并存储为长期记忆。在未来的对话中，当聊到相关话题时，AI会主动检索这些记忆，让回应更加个性化、有深度、有连续性。这让用户感觉自己真正被“记住”了，从而建立起深厚的情感连接。

*   **我的实现：**
    我通过`CharacterMemoryService`和PostgreSQL数据库的`vector`扩展，实现了**RAG（检索增强生成）**技术。AI模型在对话中会判断哪些信息值得被“记住”，并将其向量化后存入数据库。当用户开启新的对话时，AI会先根据当前话题判断是否需要检索相关的记忆，并将这些记忆作为背景知识融入到提示词中，从而做出更贴心、更连贯的回应。

##### **4.2 文生图（视觉创造能力）**

*   **技能描述：**
    AI角色不仅能说，还能“画”。在对话的特定情境下，AI可以调用文生图的能力，将文字描述的场景或形象具象化为图片。例如，用户可以让角色“画一张你的自画像”，或者在共同构建一个幻想故事时，让AI“画出我们正在探索的魔法森林”。这极大地丰富了互动的维度，将想象力转化为可见的现实，提供了无与伦比的创造性和趣味性。甚至是角色表达情绪的一种方式。

*   **我的实现：**
    我利用了Gemini强大的多模态能力，在`ImageGenerationService`中封装了文生图的逻辑。AI模型经过我的特定Prompt调教，学会了在对话中通过输出一个特殊的指令（如 `[DO]imagen(isSelf=true, description="一个开心的微笑")`）来触发图片生成。后端服务会解析这个指令，并调用图像生成接口，最终将生成的图片通过WebSocket推送给用户。整个过程对用户来说是无缝且自然的，仿佛是AI角色施展的一项技能。